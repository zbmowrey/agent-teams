# ADR-001: Roadmap File Structure

## Status

Proposed

## Context

The wizards project needs a roadmap system that:
1. Multiple agents can read concurrently during `/plan-product` and `/build-product` operations
2. Avoids file-level write conflicts when parallel agents update roadmap state
3. Provides machine-readable metadata (status, priority, dependencies) that agents can parse
4. Supports the existing status convention (ðŸ”´ðŸŸ¡ðŸŸ¢ðŸ”µâœ…â›”) referenced in skill files
5. Scales as the project grows without degrading agent performance

The DBA identified a concrete risk: during `/plan-product`, the Researcher and Architect operate in parallel. If both write to a shared roadmap file simultaneously, one agent's changes are lost. The same risk exists in `/build-product` with Backend and Frontend engineers.

## Decision

### One file per roadmap item

Each roadmap item gets its own file in `docs/roadmap/` named `{priority}-{slug}.md` (e.g., `P1-01-concurrent-write-safety.md`). This eliminates write conflicts entirely â€” no two agents should ever modify the same roadmap item simultaneously.

A lightweight `_index.md` file provides a human-readable overview. It is regenerated by the team lead at the end of each planning cycle, never during parallel work.

### YAML frontmatter for structured metadata

Each item file uses YAML frontmatter for machine-parseable fields:

```yaml
---
title: "Feature Name"
status: "not_started"          # not_started | spec_in_progress | ready | impl_in_progress | complete | blocked
priority: "P1"                 # P1 (critical) | P2 (important) | P3 (nice-to-have)
category: "core-framework"     # See categories below
effort: "medium"               # small (< 1 session) | medium (1-2 sessions) | large (3+ sessions)
impact: "high"                 # low | medium | high
dependencies: []               # List of other roadmap item slugs
created: "YYYY-MM-DD"
updated: "YYYY-MM-DD"
---
```

### Status mapping to existing emoji convention

The YAML `status` field maps to the emoji convention already in skill files:

| YAML status         | Emoji | Meaning                    |
|---------------------|-------|----------------------------|
| `not_started`       | ðŸ”´    | No work begun              |
| `spec_in_progress`  | ðŸŸ¡    | Spec being written         |
| `ready`             | ðŸŸ¢    | Spec approved, ready to build |
| `impl_in_progress`  | ðŸ”µ    | Implementation underway    |
| `complete`          | âœ…    | Done and verified          |
| `blocked`           | â›”    | Cannot proceed             |

## Alternatives Considered

### Single roadmap file
Simpler to read but creates write contention between parallel agents. Rejected.

### Database or JSON state file
More structured but harder for agents and humans to read/edit. Markdown with YAML frontmatter is native to the agent workflow. Rejected.

### Directory-per-item (like specs)
Overkill for roadmap items which are lightweight pointers. A single file per item is sufficient. The `docs/specs/` directory already handles detailed specifications. Rejected.

## Consequences

- **Positive**: No concurrent write conflicts. Agents can safely update their assigned items in parallel.
- **Positive**: YAML frontmatter enables programmatic filtering (e.g., "find all P1 items with status ready").
- **Positive**: Human-readable â€” anyone can browse `docs/roadmap/` and understand the backlog.
- **Negative**: Index file can become stale if not regenerated. Mitigated by treating `_index.md` as a convenience view, not the source of truth.
- **Negative**: More files to manage. Mitigated by the naming convention which provides natural sort order.
